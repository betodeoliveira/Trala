<script>
    // Variables
    let currentQuestion = 0;
    let totalQuestions = $(".lead-gen_question").length;

    // Configurate sections
    $(".section_lead-gen-intro").css("display", "flex");
    $(".section_lead-gen-form").css("display", "none");
    $(".section_lead-gen-form").css("opacity", "0");
    $(".section_lead-gen-nav").css("display", "none");
    $(".section_lead-gen-nav").css("opacity", "0");
    // Other configurations
    $(".lead-gen_radio-button").removeClass("is-active");
    $(".lead-gen_prev-button_wrapper").css("opacity", "0");

    // Intro
    $("[lead-gen-start-form]").on("click", function () {
        // Transit sections
        gsap.to(".section_lead-gen-intro", {
            opacity: 0, duration: 0.25,
            onComplete() {
                $(".section_lead-gen-intro").css("display", "none");
                $(".section_lead-gen-form").css("display", "block");
                $(".section_lead-gen-nav").css("display", "block");
                gsap.to(".section_lead-gen-form", { opacity: 1, duration: 0.25 });
                gsap.to(".section_lead-gen-nav", { opacity: 1, duration: 0.25 });
                checkForAnswer();
            }
        });

        // Hide music notes
        gsap.to(".header-notes_right-component", { opacity: 0, duration: 0.25 });
    });

    // Form navigation next
    $("[lead-gen-next]").on("click", function () {
        nextFormSlide();
    });

    $(document).keypress(function (event) {
        if (event.which == '13') { // enter pressed
            event.preventDefault();  // stops its action
            nextFormSlide();
        }
    });

    $(document).keydown(function (objEvent) {
        if (objEvent.keyCode == 9) {  //tab pressed
            objEvent.preventDefault(); // stops its action
            nextFormSlide();
        }
    })

    // Form navigation previous
    $("[lead-gen-prev]").on("click", function () {
        prevFormSlide();
    });

    $(document).keydown(function (event) {
        if (event.which == '37') { // left key pressed
            event.preventDefault();  // stops its action
            prevFormSlide();
        }
    });

    function nextFormSlide() {
        if (currentQuestion >= totalQuestions || $("[lead-gen-next]").hasClass("is-disabled")) {
            return;
        }
        else {
            $(".lead-gen_form-next").click();
            currentQuestion++;
            checkForAnswer();
        }
    }

    function prevFormSlide() {
        if (currentQuestion <= 0) {
            return;
        }
        else {
            $(".lead-gen_form-prev").click();
            currentQuestion--;
            checkForAnswer();
        }
    }

    // Add or remove is active from radio buttons
    $(".lead-gen_radio-button").on("click", function () {
        if (!$(this).hasClass("is-active")) {
            // Remove from every button
            $(".lead-gen_radio-button").removeClass("is-active");
            $(this).addClass("is-active");
            checkForAnswer();
        }
    });

    //
    $(".form_input").change(function() {
        checkForAnswer();
    });

    function checkForAnswer() {

        let questionType = $(".lead-gen_question").eq(currentQuestion).attr("lead-gen-question-type");

        if (questionType == "radio") {
            if ($(".lead-gen_question").eq(currentQuestion).find(".lead-gen_radio-button.is-active").length <= 0) {
                checkNextButton(false);
            }
            else {
                checkNextButton(true);
            }
        }
        else if (questionType == "input") {
            if ($(".lead-gen_question").eq(currentQuestion).find(".form_input").val().length <= 0) {
                checkNextButton(false);
            }
            else {
                checkNextButton(true);
            }
        }
    }

    function checkNextButton(active) {
        if (!active) {
            if (!$("[lead-gen-next]").hasClass("is-disabled")) {
                $("[lead-gen-next]").addClass("is-disabled");
            }
        }
        else {
            $("[lead-gen-next]").removeClass("is-disabled");
        }
    }
</script>